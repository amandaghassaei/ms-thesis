%% This is an example first chapter.  You should put chapter/appendix that you
%% write into a separate file, and add a line \include{yourfilename} to
%% main.tex, where `yourfilename.tex' is the name of the chapter/appendix file.
%% You can process specific files by typing their names in at the 
%% \files=
%% prompt when you run the file main.tex through LaTeX.

\singlespacing{


\chapter{Simulation Engine}

\section{Material Types}

We chose a relatively small basis set of material types which cover a range of desirable material properties for actuation and control.  The list of materials and a qualitative comparison of their properties is given in Table \ref{tab:materialTypes}.

\renewcommand{\arraystretch}{1.5}
%http://tex.stackexchange.com/questions/98388/how-to-make-table-with-rotated-table-headers-in-latex
\begin{table}[h] \label{tab:materialTypes}
    \centering
    \caption{Basis Set of Material Types.}
\begin{tabular}{ll | m{4cm} | *{7}{c} }
    \\
    \multicolumn{2}{c}{Function}  & \multicolumn{1}{c}{Example Materials}
        & \mcrot{1}{l}{60}{Cost} & \mcrot{1}{l}{60}{Strength} & \mcrot{1}{l}{60}{Stiffness} & \mcrot{1}{l}{60}{Fracture Resistance} & \mcrot{1}{l}{60}{Heat Resistance} & \mcrot{1}{l}{60}{Density} & \mcrot{1}{l}{60}{Magnetic Coercivity}\\
    \midrule \midrule

    \multirow{4}{*}{\rotatebox{90}{\textbf{\small{\hspace{17pt}Structural}}}}
    & Insulating & Plastics&
        x & x & x & xxx & x & xxx & -\\
    & Non-Insulating &   Metals  &
        xx & xxx & xxx & xx & xxx 
        & xx & -\\
    & Heat-Resistant&     Inconel, Alumina&
        xxxx &xx &xxxx &x &xxxx &xx & -\\
    \midrule
    \multirow{4}{*}{\rotatebox{90}{\textbf{\small{\hspace{18pt}Flexible}}}}
    & Insulating & Rubber
        & x & x & - & - & x 
        & - & x \\
    & Conductive & Metal wire   
        & x & x & - & - & x 
        & - & x\\
    & Hinge&    Metal flexure   
        & - & - & x & - & - 
        & - & -\\
        
      \midrule
     \multirow{4}{*}{\rotatebox{90}{\textbf{\small{\hspace{14pt}Conductive}}}}
    & General Purpose & Copper
        & x & x & - & - & x 
        & - & x\\
    & Lightweight &    Aluminum    
        & - & - & x & - & - 
        & - & -\\
    & Resistive&    Carbon-filled ceramic
        & - & - & x & - & - 
        & - & -\\
        
        
        \midrule
     \multirow{4}{*}{\rotatebox{90}{\textbf{\small{\hspace{16pt}Magnetic}}}}
    & Hard & NdFeB (neodymium)
        & x & x & - & - & x 
        & - & x\\
    & Soft &    AlNiCo   
        & - & - & x & - & - 
        & - & -\\
    & Ferromagnetic &    Iron     
        & - & - & x & - & - 
        & - & - \\
        
          \midrule
     \multirow{4}{*}{\rotatebox{90}{\textbf{\small{\hspace{50pt}Actuators}}}}
    & Piezoelectric & PZT (lead zirconate titanate)
        & x & x & - & - & x 
        & - & x\\
    & Heat Actuator &    Parrafin Wax
        & - & - & x & - & - 
        & - & -\\
        
         \midrule
     \multirow{4}{*}{\rotatebox{90}{\textbf{\small{Logic}}}}
    & NMOS & Silicon MOSFET
        & x & x & - & - & x 
        & - & x\\
    & PMOS &    Silicon MOSFET
        & - & - & x & - & - 
        & - & -\\
    & Diode &    Silicon     
        & - & - & x & - & - 
        & - & - \\
    & Zener Diode &    Silicon     
        & - & - & x & - & - 
        & - & - \\
        
        
        
    \bottomrule
\end{tabular}
\end{table}


\section{Hello World}

Before diving into more complex models, I wrote a "hello world" simulation engine to better understand how all the pieces of simulation (electronic, mechanical, and magnetic) would come together.

\subsection{Simple Mechanical Simulation}

I started with a simple dynamic mechanical model where the forces acting on each voxel in the lattice are computed based on local interactions with its six neighbors and gravity (Fig \ref{fig: helloWorldLocalInteraction}, Fig \ref{fig: helloWorldSpring}).\\

\begin{figure}
  \includegraphics[width=\linewidth]{helloWorldLocalInteraction.png}
  \caption{REPLACE THIS Each cell is face-connected to its six local neighbors \textbf{(A)}.  Interaction between neighbors is modeled with springs constraining translational and rotational motion \textbf{(B)}.}
  \label{fig: helloWorldLocalInteraction}
\end{figure}

\begin{figure}
  \includegraphics[width=\linewidth]{helloWorldSpring.png}
  \caption{REPLACE THIS Total forces acting on each cell include the force of gravity and the force of all neighboring spring constraints \textbf{(A)}. Larger translational and rotational displacements between neighboring cells increase the amplitude of spring forces \textbf{(B)}.}
  \label{fig: helloWorldSpring}
\end{figure}

To understand how the translational spring forces were calculated between two adjacent cells, consider the 2D case illustrated in Fig \ref{fig: helloWorldSpringSetup}.  The cells are attached by a spring with nominal length $\ell$.  Under displacement $\Delta x$ and $\Delta y$, the distance vector from cell A to cell B is given by $\vec{D}$.  Then $\Delta \ell$, the displacement of the spring from its nominal length, is given by:\\

\[ \Delta \ell = \| D\| - \ell\]

The force, $\vec{f}_{AB}$, exerted on cell A by a spring with stiffness $k$ is oriented in the same direction as $\vec{D}$:

\[ \vec{f}_{AB} =  k (\hat{D} \Delta \ell) = k\hat{D} (\|D\| - \ell)\]

An equal and opposite force, $\vec{f}_{BA}$, is applied to cell B by the spring:

\[ \vec{f}_{BA} = -k\hat{D} (\|D\| - \ell)\]

The stiffness $k$ of the spring is determined from the material properties of the two cells.  In the case that the two cells have different stiffnesses, a composite stiffness is used according to:

\[ k = \frac{2k_Ak_B}{k_A + k_B} \]

\begin{figure}
  \includegraphics[width=\linewidth]{helloWorldSpringSetup.png}
  \caption{REPLACE THIS Cubes A and B connected by spring with nominal length $\ell$ \textbf{(A)}.  The cells are displaced by $\Delta x$ and $\Delta y$ \textbf{(B)}. Spring displacement $\Delta \ell$ along $\vec{D}$ \textbf{( C )}.  $\vec{f}_{AB}$ and $\vec{f}_{BA}$ are the resulting translational spring forces applied to cells A and B, respectively \textbf{(D)}.}
  \label{fig: helloWorldSpringSetup}
\end{figure}

The rotational spring constraints are illustrated in \\

\begin{figure}
  \includegraphics[width=\linewidth]{helloWorldSpringSetup.png}
  \caption{REPLACE THIS Cubes A and B connected by spring with nominal displacement $\ell$ \textbf{(A)}.  The cells are further displaced by $\Delta x$ and $\Delta y$ \textbf{(B)}. Spring displacement $\Delta \ell$ along $\vec{D}$ \textbf{©}.  $\vec{f_{AB}}$ is the translational spring resulting force applied to cell A by the spring attached to cell B, force of gravity, $f_g$, also indicated \textbf{(D)}.}
  \label{fig: helloWorldSpringRotSetup}
\end{figure}

Then the total force applied to the cell is given by:

\[ F_{total} =  \vec{f}_g+ \sum_{neighbors} (\vec{f}_{translational} + \vec{f}_{rotational}) \]







}
